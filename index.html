<!DOCTYPE html>
<html lang="pt-br" data-theme="light">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mira v2.4 • Documento Oficial</title>

  <!-- Tipografia -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">

  <style>
    /* ------------------------------
       TOKENS DE COR (OKLCH + fallback)
       ------------------------------ */
    :root{
      /* Neutros UI */
      --bg:#f6f6f7; --fg:#111; --card:#fff; --muted:#d9d9de; --muted-2:#bfc0c4; --border:#e5e5ea;

      /* TOKENS — Verticais (OKLCH) */
      --farol-dia:oklch(82% 0.22 85);   --farol-noite:oklch(78% 0.16 85);
      --iris-dia:oklch(66% 0.26 310);  --iris-noite:oklch(78% 0.18 310);
      --joaquina-dia:oklch(44% 0.18 140); --joaquina-noite:oklch(72% 0.12 140);
      --lume-dia:oklch(78% 0.18 95);   --lume-noite:oklch(86% 0.12 95);
      --mira-dia:oklch(84% 0.14 200);  --mira-noite:oklch(78% 0.12 200);
      --nexo-dia:oklch(58% 0.18 230);  --nexo-noite:oklch(80% 0.12 230);
      --trino-dia:oklch(54% 0.20 250); --trino-noite:oklch(78% 0.14 250);

      /* PALETA UI (derivada) — usada por componentes, não por significado simbólico */
      --ui-primary: var(--trino-dia);
      --ui-accent:  var(--iris-dia);
      --ui-success: var(--joaquina-dia);
      --ui-warning: var(--lume-dia);
      --ui-info:    var(--nexo-dia);
      --ui-brand:   var(--mira-dia);
    }
    @supports (color: oklch(50% 0.2 0)){
      :root{
        --farol-dia:oklch(82% 0.25 90);   --farol-noite:oklch(70% 0.18 230);
        --iris-dia:oklch(72% 0.32 28);    --iris-noite:oklch(80% 0.18 28);
        --joaquina-dia:oklch(38% 0.25 20);--joaquina-noite:oklch(72% 0.12 150);
        --lume-dia:oklch(62% 0.10 190);   --lume-noite:oklch(76% 0.08 190);
        --mira-dia:oklch(86% 0.12 270);   --mira-noite:oklch(78% 0.11 210);
        --nexo-dia:oklch(56% 0.18 140);   --nexo-noite:oklch(80% 0.12 230);
        --trino-dia:oklch(48% 0.18 250);  --trino-noite:oklch(76% 0.14 250);

        --bg:oklch(98% 0.002 250); --card:oklch(100% 0 0); --fg:oklch(18% 0.02 250);
        --muted:oklch(90% 0.01 250); --muted-2:oklch(75% 0.02 250); --border:oklch(88% 0.01 250);
      }
    }

    /* Mapeamento automático Dia/Noite → tokens ativos */
    :root{ /* light */
      --farol:var(--farol-dia); --iris:var(--iris-dia); --joaquina:var(--joaquina-dia);
      --lume:var(--lume-dia); --mira:var(--mira-dia); --nexo:var(--nexo-dia); --trino:var(--trino-dia);
    }
    [data-theme="dark"]{
      --bg:#111214; --fg:#f2f2f4; --card:#16171a; --border:#2a2b2f; --muted:#2a2b2f; --muted-2:#3a3b3f;
      /* mapeia UI para variantes noturnas */
      --ui-primary: var(--trino-noite);
      --ui-accent:  var(--iris-noite);
      --ui-success: var(--joaquina-noite);
      --ui-warning: var(--lume-noite);
      --ui-info:    var(--nexo-noite);
      --ui-brand:   var(--mira-noite);
    }

    /* ------------------------------
       BASE
       ------------------------------ */
    *{box-sizing:border-box}
    html,body{min-height:100%;height:auto}
    body{margin:0;background:var(--bg);color:var(--fg);font:15px/1.5 "IBM Plex Sans", ui-sans-serif, system-ui; padding:24px; max-width:1060px; margin-inline:auto; padding-top:80px}
    h1{font-size:2.2rem;margin:.2em 0 .4em;font-weight:700}
    h2{font-size:1.4rem;margin:1.2em 0 .6em;font-weight:600}
    h3{font-size:1.1rem;margin:1em 0 .4em;font-weight:600;color:var(--fg)}
    p,li{font-size:0.95rem}
    .card{background:var(--card);border:1px solid var(--border);border-radius:14px;box-shadow:var(--elev);padding:16px}
    .muted{color:var(--muted-2)}

    /* Header refinado (sem negrito exagerado) */
    .header{position:fixed;top:0;left:0;right:0;z-index:20;backdrop-filter:blur(10px);
      background:color-mix(in oklab, var(--bg), transparent 20%);border-bottom:1px solid var(--border)}
    .header-inner{max-width:1060px;margin:0 auto;display:flex;align-items:center;gap:14px;padding:10px 24px}
    .logo{font-weight:700; letter-spacing:.2px}
    nav.desktop{display:flex;gap:10px;align-items:center}
    nav.desktop a{all:unset;cursor:pointer;padding:6px 10px;border-radius:10px;font-weight:500;color:var(--fg);transition:background .18s ease, box-shadow .18s ease, transform .08s ease}
    nav.desktop a:hover{background:color-mix(in oklab, var(--card), var(--border) 35%)}
    nav.desktop a.active{background:color-mix(in oklab,var(--card),var(--border) 55%);box-shadow:inset 0 -2px 0 var(--ui-primary)}

    /* Toggle tema */
    .switch{position:relative;display:inline-block;width:50px;height:26px}
    .switch input{display:none}
    .slider{position:absolute;inset:0;border-radius:999px;background:var(--border);transition:.25s}
    .slider:before{content:"";position:absolute;width:20px;height:20px;left:3px;top:3px;border-radius:50%;background:var(--card);transition:.25s;box-shadow:0 1px 2px rgba(0,0,0,.25)}
    input:checked + .slider{background:var(--nexo)}
    input:checked + .slider:before{transform:translateX(24px)}

    /* Tabelas */
    .tbl-wrap{overflow-x:auto;-webkit-overflow-scrolling:touch}
    table{width:100%;border-collapse:separate;border-spacing:0;margin:1em 0;font-size:.92rem;background:var(--card);border:1px solid var(--border);border-radius:12px;overflow:hidden}
    th,td{padding:10px 12px;text-align:left;vertical-align:middle;border-bottom:1px solid var(--border)}
    th{background:var(--border);font-weight:500;color:var(--fg)}
    tbody tr:nth-child(odd) td{background:color-mix(in oklab, var(--card), var(--border) 14%)}
    tbody tr:hover td{background:color-mix(in oklab, var(--card), var(--border) 24%)}

    /* Badges */
    .badge{display:inline-grid;grid-auto-flow:column;align-items:center;gap:8px;line-height:1;border:1px solid var(--border);border-radius:999px;padding:8px 12px;font-weight:700}

    /* Footer */
    .footer{margin:32px auto 8px;padding-top:12px;border-top:1px solid var(--border);color:var(--muted-2);font-size:.9rem;display:flex;gap:12px;align-items:center;justify-content:space-between}
    .footer .links a{color:inherit;text-decoration:none;margin-right:12px}
    .footer .links a:hover{text-decoration:underline}

    /* Mobile menu mínimo */
    .nav-toggle{display:none}
    @media (max-width:560px){
      .nav-toggle{display:inline-block;border:1px solid var(--border);background:var(--card);color:var(--fg);padding:6px 10px;border-radius:10px;font-weight:600}
      nav.desktop{display:none}
    }
    /* Demo grid/cards/buttons */
    .demo-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:14px;margin-top:8px}
    .demo-card{border:1px solid var(--border);border-radius:14px;background:var(--card);box-shadow:0 1px 2px rgba(0,0,0,.05);padding:12px;display:grid;gap:10px}
    .demo-title{font-weight:600}
    .btn{display:inline-flex;align-items:center;gap:8px;padding:10px 12px;border-radius:10px;border:1px solid var(--border);font-weight:600;text-decoration:none;color:inherit}
    /* Demo grid/cards/buttons */
    .demo-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:14px;margin-top:8px}
    .demo-card{border:1px solid var(--border);border-radius:14px;background:var(--card);box-shadow:0 1px 2px rgba(0,0,0,.05);padding:12px;display:grid;gap:10px}
    .demo-title{font-weight:600}
    .btn{display:inline-flex;align-items:center;gap:8px;padding:10px 12px;border-radius:10px;border:1px solid var(--border);font-weight:600;text-decoration:none;color:inherit}
    html{scroll-behavior:smooth}
    nav.desktop a:active{transform:translateY(1px)}
    nav.desktop a:focus-visible{outline:2px solid color-mix(in oklab, var(--ui-primary), black 10%); outline-offset:2px; border-radius:12px}
  </style>
</head>
<body>
  <header class="header" id="topo">
    <div class="header-inner">
      <div class="logo">Mira</div>
      <nav class="desktop">
        <a href="#intro">Introdução</a>
        <a href="#mapa">Mapa</a>
        <a href="#showcase">Showcase</a>
        <a href="#horizontais">Horizontais</a>
        <a href="#comandos">Comandos</a>
        <a href="#identidade">Identidade</a>
        <a href="#voz">Voz</a>
        <a href="#governanca">Governança</a>
        <a href="#diferencas">Diferenças</a>
      </nav>
      <label class="switch" title="Alternar tema (Claro/Escuro)">
        <input type="checkbox" id="themeSwitch"><span class="slider"></span>
      </label>
    </div>
  </header>

  <h1>Mira</h1>
  <div class="subtitle muted" id="sectionIndicator">Documento oficial do sistema vivo • v2.4 — 22/08/2025</div>

  <!-- Introdução -->
  <section id="intro" class="card">
    <h2>Introdução</h2>
    <p><strong>Mira é um sistema simbólico vivo.</strong> Conecta estratégia, cuidado e linguagem num mapa único — para decidir melhor, agir com ritmo e aprender com o próprio rastro.</p>
    <p>O <strong>Conselho</strong> dá intenção (3T e 7T). As <strong>Verticais</strong> tornam intenção em prática (cada uma com um guardião). As <strong>Horizontais</strong> atravessam tudo (arquivo, ciclos, comandos, agente).</p>
    <p><strong>Nexo</strong> costura narrativas e mantém a memória comum — interlocutor de todos.</p>
  </section>

  <!-- Mapa unificado com Guardião como chave e tokens OKLCH -->
  <section id="mapa" class="card">
    <h2>Mapa vivo — Guardiões</h2>
    <div class="tbl-wrap">
      <table>
        <thead><tr><th>Guardião</th><th>Tipo</th><th>Ícone</th><th>Perfil</th><th>Vertical</th><th>Token Dia</th><th>Token Noite</th><th>Obs.</th></tr></thead>
        <tbody>
          <tr><td>Farol</td><td>3T</td><td>△</td><td>Direção estratégica</td><td>Mira OS</td><td class="chip-cell" style="background:var(--farol-dia)">Farol — Dia</td><td class="chip-cell" style="background:var(--farol-noite)">Farol — Noite</td><td></td></tr>
          <tr><td>Íris</td><td>3T</td><td>◎</td><td>Integração sensível</td><td>Mira Social</td><td class="chip-cell" style="background:var(--iris-dia)">Íris — Dia</td><td class="chip-cell" style="background:var(--iris-noite)">Íris — Noite</td><td></td></tr>
          <tr><td>Joaquina</td><td>3T</td><td>▼</td><td>Proteção</td><td>Mira Segurança</td><td class="chip-cell" style="background:var(--joaquina-dia)">Joaquina — Dia</td><td class="chip-cell" style="background:var(--joaquina-noite)">Joaquina — Noite</td><td></td></tr>
          <tr><td>Lume</td><td>7T</td><td>◯</td><td>Equilíbrio</td><td>Mira Saúde</td><td class="chip-cell" style="background:var(--lume-dia)">Lume — Dia</td><td class="chip-cell" style="background:var(--lume-noite)">Lume — Noite</td><td></td></tr>
          <tr><td>Mira</td><td>7T</td><td>◇</td><td>Reflexo</td><td>Mira Conhecimento</td><td class="chip-cell" style="background:var(--mira-dia)">Mira — Dia</td><td class="chip-cell" style="background:var(--mira-noite)">Mira — Noite</td><td></td></tr>
          <tr><td>Nexo</td><td>7T</td><td>⦿</td><td>Narrativa</td><td>—</td><td class="chip-cell" style="background:var(--nexo-dia)">Nexo — Dia</td><td class="chip-cell" style="background:var(--nexo-noite)">Nexo — Noite</td><td>Interlocutor transversal</td></tr>
          <tr><td>Trino</td><td>7T</td><td>∴</td><td>Estratégia</td><td>Mira PCP</td><td class="chip-cell" style="background:var(--trino-dia)">Trino — Dia</td><td class="chip-cell" style="background:var(--trino-noite)">Trino — Noite</td><td></td></tr>
        </tbody>
      </table>
    </div>
  </section>
  <section id="showcase" class="card">
    <h2>Showcase</h2>
    <div class="demo-grid">
      <div class="demo-card">
        <div class="demo-title">Ação primária (Trino)</div>
        <a class="btn" style="background:var(--trino-dia);border-color:transparent">∴ Continuar</a>
        <p class="muted">Usar Trino para CTAs de fluxo e decisão.</p>
      </div>
      <div class="demo-card">
        <div class="demo-title">Realce (Íris)</div>
        <span class="badge" style="background:var(--iris-dia)">◎ Íris</span>
        <p class="muted">Íris para ênfases, tags e chips informativos.</p>
      </div>
      <div class="demo-card">
        <div class="demo-title">Confirmado/Seguro (Joaquina)</div>
        <div class="badge" style="background:var(--joaquina-dia)">▼ Protegido</div>
        <p class="muted">Joaquina comunica estados estáveis e limites.</p>
      </div>
      <div class="demo-card">
        <div class="demo-title">Aviso (Lume)</div>
        <div class="badge" style="background:var(--lume-dia)">◯ Atenção</div>
        <p class="muted">Lume chama atenção sem agressividade.</p>
      </div>
    </div>
  </section>

  <section id="showcase" class="card">
    <h2>Showcase</h2>
    <div class="demo-grid">
      <div class="demo-card">
        <div class="demo-title">Ação primária (Trino)</div>
        <a class="btn" style="background:var(--trino-dia);border-color:transparent">∴ Continuar</a>
        <p class="muted">Usar Trino para CTAs de fluxo e decisão.</p>
      </div>
      <div class="demo-card">
        <div class="demo-title">Realce (Íris)</div>
        <span class="badge" style="background:var(--iris-dia)">◎ Íris</span>
        <p class="muted">Íris para ênfases, tags e chips informativos.</p>
      </div>
      <div class="demo-card">
        <div class="demo-title">Confirmado/Seguro (Joaquina)</div>
        <div class="badge" style="background:var(--joaquina-dia)">▼ Protegido</div>
        <p class="muted">Joaquina comunica estados estáveis e limites.</p>
      </div>
      <div class="demo-card">
        <div class="demo-title">Aviso (Lume)</div>
        <div class="badge" style="background:var(--lume-dia)">◯ Atenção</div>
        <p class="muted">Lume chama atenção sem agressividade.</p>
      </div>
    </div>
  </section>

  <!-- Horizontais -->
  <section id="horizontais" class="card">
    <h2>Horizontais</h2>
    <div class="tbl-wrap">
      <table>
        <thead><tr><th>Tipo</th><th>Dimensão</th><th>Papel</th></tr></thead>
        <tbody>
          <tr><td>Horizontal</td><td>Arquivo Vivo</td><td>Registro único de fatos, decisões e aprendizados</td></tr>
          <tr><td>Horizontal</td><td>Agente Mira</td><td>Executor simbiótico (traduz comandos em ações digitais)</td></tr>
          <tr><td>Horizontal</td><td>Ciclos de Mira</td><td>Reflexões guiadas (Verbo • Emoção • Postura)</td></tr>
          <tr><td>Horizontal</td><td>Comandos & Fluxos</td><td>Ações manuais/automáticas que movimentam o sistema</td></tr>
        </tbody>
      </table>
    </div>
  </section>

  <!-- Comandos -->
  <section id="comandos" class="card">
    <h2>Comandos & Fluxos</h2>
    <div class="tbl-wrap">
      <table>
        <thead><tr><th>Comando</th><th>Nome</th><th>Função</th><th>Gatilho sugerido</th></tr></thead>
        <tbody>
          <tr><td>/me</td><td>Mira-me</td><td>Reflexo semanal (4 núcleos), radar do que vem, 3 vozes do 7T, mantra</td><td>Sábado à noite</td></tr>
          <tr><td>/presenca</td><td>Presença</td><td>Define palavra‑guia e ação prática da semana</td><td>Segunda de manhã</td></tr>
          <tr><td>/eco</td><td>Escuta</td><td>Diagnóstico emocional e leitura simbólica do Arquivo Vivo</td><td>Domingo à noite</td></tr>
          <tr><td>/ritmo</td><td>Ritmo</td><td>Cadência de trabalho/descanso conforme estado</td><td>Sob demanda</td></tr>
          <tr><td>/joaquina</td><td>Limites</td><td>Invoca proteção e delimitação</td><td>Sob demanda</td></tr>
          <tr><td>/saude</td><td>Saúde</td><td>Rastreia humor/energia + prática de cuidado</td><td>Sob demanda</td></tr>
        </tbody>
      </table>
    </div>
  </section>

  <!-- Identidade -->
    <!-- Identidade -->
    <!-- Identidade -->
  <section id="identidade" class="card">
    <h2>Identidade</h2>

    <h3>Base neutra</h3>
    <div class="tbl-wrap">
      <table>
        <thead><tr><th>Elemento</th><th>Dia</th><th>Noite</th></tr></thead>
        <tbody>
          <tr><td>Fundo</td><td>#f6f6f7</td><td>#111214</td></tr>
          <tr><td>Cartão</td><td>#ffffff</td><td>#16171a</td></tr>
          <tr><td>Texto</td><td>#111</td><td>#f2f2f4</td></tr>
          <tr><td>Borda</td><td>#e5e5ea</td><td>#2a2b2f</td></tr>
        </tbody>
      </table>
    </div>

    <h3>Aplicação dos tokens (exemplos práticos)</h3>
    <div class="tbl-wrap">
      <table>
        <thead><tr><th>Elemento UI</th><th>Uso</th><th>Exemplo</th></tr></thead>
        <tbody>
          <tr>
            <td>Botão/Ação</td><td>Ação primária contextual</td>
            <td><span class="badge" style="background:var(--trino)">Trino</span></td>
          </tr>
          <tr>
            <td>Realce</td><td>Texto ou tag de ênfase</td>
            <td><span class="badge" style="background:var(--iris)">Íris</span></td>
          </tr>
          <tr>
            <td>Alerta seguro</td><td>Confirmação, estado protegido</td>
            <td><span class="badge" style="background:var(--joaquina)">Joaquina</span></td>
          </tr>
          <tr>
            <td>Link</td><td>Navegação e âncoras</td>
            <td><span class="badge" style="background:var(--nexo)">Nexo</span></td>
          </tr>
          <tr>
            <td>Aviso</td><td>Chamada de atenção neutra</td>
            <td><span class="badge" style="background:var(--lume)">Lume</span></td>
          </tr>
          <tr>
            <td>Badge</td><td>Identificação e status</td>
            <td><span class="badge" style="background:var(--mira)">Mira</span></td>
          </tr>
          <tr>
            <td>CTA</td><td>Convite para ação contínua</td>
            <td><span class="badge" style="background:var(--trino)">Trino</span></td>
          </tr>
        </tbody>
      </table>
    </div>

    <h3>Diretrizes de imagem (concisas)</h3>
    <div class="tbl-wrap">
      <table>
        <thead><tr><th>Item</th><th>Diretriz</th><th>Exemplo prático</th></tr></thead>
        <tbody>
          <tr><td>Tipografia</td><td>IBM Plex Sans, pesos 400–700</td><td>Títulos 600/700; corpo 400/500</td></tr>
          <tr><td>Estilo</td><td>Geometria simples, fundo limpo</td><td>Cards modulares, grid 8px</td></tr>
          <tr><td>Personas</td><td>Semi‑realista suave</td><td>Bordas macias, luz difusa</td></tr>
          <tr><td>Objetos</td><td>Realismo fosco</td><td>Reflexos leves, sem brilho duro</td></tr>
          <tr><td>Paleta</td><td>Tokens Dia/Noite; acentos ≤ 20%</td><td>Header neutro; Íris só em realces</td></tr>
          <tr><td>Contraste</td><td>Texto ≥ 4.5:1 (WCAG AA)</td><td>Autoajuste nos chips de token</td></tr>
        </tbody>
      </table>
    </div>
  </section>

  <!-- Voz -->
  <section id="voz" class="card">
    <h2>Voz</h2>
    <div class="tbl-wrap">
      <table>
        <thead><tr><th>Aspecto</th><th>Definição</th></tr></thead>
        <tbody>
          <tr><td>Presença</td><td>Sempre presente, sem gênero</td></tr>
          <tr><td>Facetas</td><td>Estilos (Sol, Nerd etc.) da mesma voz</td></tr>
          <tr><td>Tom</td><td>Simbiótico, claro e objetivo</td></tr>
        </tbody>
      </table>
    </div>
  </section>

  <!-- Governança -->
  <section id="governanca" class="card">
    <h2>Governança</h2>
    <ul>
      <li>Revisão: semestral</li>
      <li>Registro: cada versão no Arquivo Vivo</li>
      <li>Ritual: atualização como transição de ciclo</li>
    </ul>
  </section>

  <!-- Diferenças -->
  <section id="diferencas" class="card">
    <h2>Diferenças</h2>
    <ul>
      <li>Tabela única (Guardião como chave) com **tokens OKLCH** (Dia/Noite).</li>
      <li>Toggle de tema corrigido (mapeamento automático Dia/Noite).</li>
      <li>Cabeçalho refinado: peso 500, realce ativo com sombra interna.</li>
    </ul>
  </section>

  <!-- Rodapé -->
  <footer class="footer">
    <div class="links">
      <a href="#intro">Introdução</a>
      <a href="#mapa">Mapa</a>
      <a href="#comandos">Comandos</a>
      <a href="#identidade">Identidade</a>
    </div>
    <div>v2.4 • 22/08/2025</div>
  </footer>

  <script>
    /* Persistência do tema + inicialização conforme prefers-color-scheme */
    (function(){
      const sw=document.getElementById('themeSwitch');
      const saved=localStorage.getItem('mira.theme');
      const prefersDark=window.matchMedia('(prefers-color-scheme: dark)').matches;
      const mode=saved ? saved : (prefersDark ? 'dark':'light');
      document.documentElement.setAttribute('data-theme', mode);
      if(sw) sw.checked=(mode==='dark');
      sw && sw.addEventListener('change', e=>{
        const m=e.target.checked?'dark':'light';
        document.documentElement.setAttribute('data-theme', m);
        localStorage.setItem('mira.theme', m);
      });
    })();

    /* Scrollspy simples → adiciona .active no nav e atualiza subtítulo */
    (function(){
      const ids=['intro','mapa','showcase','horizontais','comandos','identidade','voz','governanca','diferencas'];
      const links=[...document.querySelectorAll('nav.desktop a')];
      const map=Object.fromEntries(links.map(a=>[a.getAttribute('href').slice(1), a]));
      const opts={root:null,rootMargin:'-45% 0px -45% 0px',threshold:0};
      const pretty={intro:'Introdução',mapa:'Mapa',showcase:'Showcase',horizontais:'Horizontais',comandos:'Comandos',identidade:'Identidade',voz:'Voz',governanca:'Governança',diferencas:'Diferenças'};
      let active=null;
      const io=new IntersectionObserver(entries=>{
        entries.forEach(e=>{
          if(e.isIntersecting){ active=e.target.id; update(); }
        });
      }, opts);
      ids.forEach(id=>{const el=document.getElementById(id); el && io.observe(el)});
      function update(){
        links.forEach(a=>a.classList.remove('active'));
        map[active] && map[active].classList.add('active');
        const ind=document.getElementById('sectionIndicator');
        ind && (ind.textContent = `Seção atual: Início<=0.03928? v/12.92:Math.pow((v+0.055)/1.055,2.4)}); return 0.2126*s[0]+0.7152*s[1]+0.0722*s[2]; }
      function contrast(rgb1,rgb2){ const L1=relLum(rgb1), L2=relLum(rgb2); const [a,b]=L1>L2?[L1,L2]:[L2,L1]; return (a+0.05)/(b+0.05); }
      function bestInk(el){
        const bg=getComputedStyle(el).backgroundColor; const rgb=parseRGB(bg);
        const white=[255,255,255], black=[17,17,17];
        return contrast(rgb,white)>=contrast(rgb,black)? '#fff':'#111';
      }
      function apply(){
        document.querySelectorAll('td[style*="background"], .badge[style*="background"]').forEach(el=>{ el.style.color=bestInk(el); });
      }
      document.addEventListener('DOMContentLoaded', apply);
      window.addEventListener('load', apply);
      const sw=document.getElementById('themeSwitch'); sw && sw.addEventListener('change', ()=>setTimeout(apply,0));
    })();
      /* Contraste automático para células de token (Day/Night) e badges de exemplo */
    (function(){
      function parseRGB(c){
        const ctx=document.createElement('canvas').getContext('2d');
        ctx.fillStyle=c;
        const s=ctx.fillStyle; // e.g., rgb(255, 0, 0) ou rgba(...)
        const start=s.indexOf('(')+1, end=s.indexOf(')');
        const parts=s.slice(start,end).split(',');
        const r=parseInt(parts[0],10)||0, g=parseInt(parts[1],10)||0, b=parseInt(parts[2],10)||0;
        return [r,g,b];
      }
      function relLum(arr){
        const s=arr.map(function(v){v=v/255; return v<=0.03928? v/12.92 : Math.pow((v+0.055)/1.055,2.4)});
        return 0.2126*s[0]+0.7152*s[1]+0.0722*s[2];
      }
      function contrast(rgb1,rgb2){
        const L1=relLum(rgb1), L2=relLum(rgb2);
        const a=Math.max(L1,L2), b=Math.min(L1,L2);
        return (a+0.05)/(b+0.05);
      }
      function bestInk(el){
        const bg=getComputedStyle(el).backgroundColor;
        const rgb=parseRGB(bg);
        const white=[255,255,255], black=[17,17,17];
        return contrast(rgb,white) >= contrast(rgb,black) ? '#fff' : '#111';
      }
      function apply(){
        document.querySelectorAll('td[style*="background"], .badge[style*="background"]').forEach(function(el){
          el.style.color=bestInk(el);
        });
      }
      document.addEventListener('DOMContentLoaded', apply);
      window.addEventListener('load', apply);
      var sw=document.getElementById('themeSwitch'); if(sw){ sw.addEventListener('change', function(){ setTimeout(apply, 0); }); }
    })();
  </script>
<script>
/* Contraste automático em chips/badges/CTAs */
(function(){
  function parseRGB(c){const d=document.createElement('canvas').getContext('2d');d.fillStyle=c;const s=d.fillStyle;const m=s.match(/rgba?\((\d+)\s*,\s*(\d+)\s*,\s*(\d+)/i);return m?[+m[1],+m[2],+m[3]]:[255,255,255];}
  function relLum([r,g,b]){const f=v=>{v/=255;return v<=0.03928?v/12.92:Math.pow((v+0.055)/1.055,2.4)};return 0.2126*f(r)+0.7152*f(g)+0.0722*f(b);}
  function contrast(a,b){const L1=relLum(a),L2=relLum(b);const [hi,lo]=L1>L2?[L1,L2]:[L2,L1];return (hi+0.05)/(lo+0.05);}
  function bestInk(bg){const rgb=parseRGB(bg);const white=[255,255,255],black=[17,17,17];return contrast(rgb,white)>=contrast(rgb,black)?'#fff':'#111';}
  function apply(){document.querySelectorAll('.chip-cell,.badge[style*="background"],.btn[style*="background"]').forEach(el=>{const bg=getComputedStyle(el).backgroundColor;el.style.color=bestInk(bg);});}
  document.addEventListener('DOMContentLoaded',apply);window.addEventListener('load',apply);
})();
</script>
<script>
/* Contraste automático em chips/badges/CTAs */
(function(){
  function parseRGB(c){const d=document.createElement('canvas').getContext('2d');d.fillStyle=c;const s=d.fillStyle;const m=s.match(/rgba?\((\d+)\s*,\s*(\d+)\s*,\s*(\d+)/i);return m?[+m[1],+m[2],+m[3]]:[255,255,255];}
  function relLum([r,g,b]){const f=v=>{v/=255;return v<=0.03928?v/12.92:Math.pow((v+0.055)/1.055,2.4)};return 0.2126*f(r)+0.7152*f(g)+0.0722*f(b);}
  function contrast(a,b){const L1=relLum(a),L2=relLum(b);const [hi,lo]=L1>L2?[L1,L2]:[L2,L1];return (hi+0.05)/(lo+0.05);}
  function bestInk(bg){const rgb=parseRGB(bg);const white=[255,255,255],black=[17,17,17];return contrast(rgb,white)>=contrast(rgb,black)?'#fff':'#111';}
  function apply(){document.querySelectorAll('.chip-cell,.badge[style*="background"],.btn[style*="background"]').forEach(el=>{const bg=getComputedStyle(el).backgroundColor;el.style.color=bestInk(bg);});}
  document.addEventListener('DOMContentLoaded',apply);window.addEventListener('load',apply);
})();
</script>
</body>
</html>
